# 11. Custom Video Player

ìƒì„±ì¼: 2021ë…„ 10ì›” 6ì¼ ì˜¤í›„ 8:28
ì†ì„±: ì•”ê³ ë„ˆ

![á„‘á…³á„…á…µá„‡á…²](https://user-images.githubusercontent.com/87363422/156252222-42f7b4f5-2a09-4e4e-b19e-ff5548ffc065.png)

```
ğŸ’¡ ë¹„ë””ì˜¤ í”Œë ˆì´ì–´ì˜ ì—¬ëŸ¬ ê¸°ëŠ¥ë“¤ì„ ì§ì ‘ êµ¬í˜„í•´ë³´ì!
```

## ë¹„ë””ì˜¤ í”Œë ˆì´ì–´ ê¸°ëŠ¥ êµ¬í˜„ ëª©ë¡

1. ì˜ìƒ ì¬ìƒ ë° ë©ˆì¶¤ ê¸°ëŠ¥
2. ì˜ìƒ ìŠ¤í‚µ ê¸°ëŠ¥
3. ì˜ìƒ ì§„í–‰ë„ í‘œì‹œ ê¸°ëŠ¥
4. ì˜ìƒ ë³¼ë¥¨ ë° ì˜ìƒ ì†ë„ ì¡°ì ˆ ê¸°ëŠ¥

---

## ì½”ë”© ê³¼ì •

### **1. ê° ìš”ì†Œë“¤ ìƒìˆ˜ë¡œ ì„ ì–¸**

```jsx
// ë¹„ë””ì˜¤ í”Œë ˆì´ì–´ ì „ì²´ div
const player = document.querySelector(".player");
// ë¹„ë””ì˜¤
const video = player.querySelector(".viewer");
// ì˜ìƒ ì§„í–‰ë„ ë°” ë‹´ì„ div
const progress = player.querySelector(".progress");
// ì˜ìƒ ì§„í–‰ë„ ë°”
const progressBar = player.querySelector(".progress__filled");
// ì˜ìƒ ì¬ìƒ ë²„íŠ¼
const toggle = player.querySelector(".toggle");
// ì§€ì •í•œ ì‹œê°„ë§Œí¼ í•œë²ˆì— ìŠ¤í‚µí•  ìŠ¤í‚µ ë²„íŠ¼
const skipButtons = player.querySelectorAll("[data-skip]");
// ë³¼ë¥¨ ë°”ì™€ ì˜ìƒì†ë„ ë°”
const ranges = player.querySelectorAll(".player__slider");
```

### **2. ì¬ìƒ ê´€ë ¨ ê¸°ëŠ¥ êµ¬í˜„**

```jsx
function togglePlay() {
  const method = video.paused ? "play" : "pause";
  // ë¬¸ìì—´ì„ ë³€ìˆ˜ë¡œ ì„ ì–¸í•´ì£¼ì—ˆìœ¼ë¯€ë¡œ ì  í‘œê¸°ë²•ì´ ì•„ë‹Œ ê´„í˜¸ í‘œê¸°ë²•ì„ í†µí•´ ì†ì„±ì— ì ‘ê·¼í•œë‹¤!
  video[method]();
}

function updateButton() {
  const icon = this.paused ? "â–º" : "âš âš";
  toggle.textContent = icon;
}

video.addEventListener("click", togglePlay);
video.addEventListener("play", updateButton);
video.addEventListener("pause", updateButton);
toggle.addEventListener("click", togglePlay);
```

```jsx
ğŸ’¡ attributeì™€ property

attributeì™€ property ë‘˜ ë‹¤ ì†ì„±ì„ ì˜ë¯¸í•˜ì§€ë§Œ ì •ì˜ë˜ëŠ” ê³³ì—ì„œ ì°¨ì´ê°€ ë°œìƒí•œë‹¤.
attributeëŠ” html document/file ì•ˆì—ì„œ elements ì— ì¶”ê°€ì ì¸ ì •ë³´ë¥¼ ë„£ì„ ë•Œ ì‚¬ìš©ë˜ëŠ” ìš”ì†Œì´ê³ ,
property ëŠ” html DOM treeì•ˆì—ì„œ attribute ë¥¼ ê°€ë¦¬í‚¤ëŠ”(í˜¹ì€ ëŒ€ì‹ í•˜ëŠ”) í‘œí˜„ì´ë‹¤.

ì´ê²ƒì´ ëœ»í•˜ëŠ” ê²ƒì€ attributeëŠ” ì •ì ìœ¼ë¡œ ë³€í•˜ì§€ ì•Šì§€ë§Œ,
propertyëŠ” DOM treeì˜ íŠ¹ì„±ìƒ ìë°”ìŠ¤í¬ë¦½íŠ¸ì— ì˜í•´ ë™ì ìœ¼ë¡œ ê·¸ ê°’ì´ ë³€í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤.
```

`HTML <video>` ì—ëŠ” ì—¬ëŸ¬ê°€ì§€ ì†ì„±ì´ ì¡´ì¬í•œë‹¤.

```jsx
** : ë³¸ ì±Œë¦°ì§€ì—ì„œ ì‚¬ìš©í•œ ì†ì„±

**attributes**
src (string): ì¬ìƒí•  ë¯¸ë””ì–´ì˜ URL(ê²½ë¡œ í¬í•¨).
poster (string): ë¯¸ë””ì–´ì— í‘œì‹œë  ëŒ€í‘œ ì´ë¯¸ì§€ì˜ URL.
controls (boolean): ì¬ìƒ ë²„íŠ¼ê³¼ ê°™ì€ ë¸Œë¼ìš°ì €ì˜ ê¸°ë³¸ ì œì–´ë„êµ¬ í‘œì‹œ. (ë¸Œë¼ìš°ì €ë§ˆë‹¤ ê¸°ë³¸ ì œì–´ë„êµ¬ê°€ ë‹¤ë¦„)
width (integer): ë¯¸ë””ì–´ í”Œë ˆì´ì–´ì˜ ë„ˆë¹„.
height (integer): ë¯¸ë””ì–´ í”Œë ˆì´ì–´ì˜ ë†’ì´.
autoplay (boolean): ë¯¸ë””ì–´ ìë™ì¬ìƒ.
loop (boolean): ë¯¸ë””ì–´ ë°˜ë³µ ì¬ìƒ.
preload (boolean): í˜ì´ì§€ë¥¼ ì½ì„ ë•Œ ë¯¸ë””ì–´ë„ ê°™ì´ ì½ì–´ë“¤ì—¬ ì¬ìƒì„ ì¤€ë¹„, `autoplay` ì†ì„±ì´ ì„¤ì •ë˜ì–´ìˆìœ¼ë©´ ë¬´ì‹œë¨.

**properties**
** CurrentTime (float): ì¬ìƒ ì¤‘ì¸ ë¯¸ë””ì–´ì˜ í˜„ì¬ ìœ„ì¹˜.
startTime (float): ì¬ìƒ ì‹œì‘ ì‹œê°„. (ë¯¸ë””ì–´ê°€ 0.0ì—ì„œ ì‹œì‘ë˜ì§€ ì•ŠëŠ” ê²½ìš°, ì˜ˆë¥¼ ë“¤ì–´ ìŠ¤íŠ¸ë¦¼)
** duration (float): ì´ˆ, ë¯¸ë””ì–´ ì´ ì¬ìƒ ê¸¸ì´.
** paused (boolean): ë¯¸ë””ì–´ ì¼ì‹œ ì •ì§€ ì—¬ë¶€. (iosì—ì„  pauseì´ë©° ì¼ì‹œì •ì§€ ë²„íŠ¼ ë¿ë§Œ ì•„ë‹ˆë¼, "Done", "ì™„ë£Œ" ë²„íŠ¼ì„ ëˆ„ë¥¼ë•Œë„ ê°™ì€ ì´ë²¤íŠ¸ë¡œ ì ìš©ëœë‹¤.)
ended (boolean): ë¯¸ë””ì–´ ì¢…ë£Œ ì—¬ë¶€.
autobuffer (boolean): ë¸Œë¼ìš°ì €ê°€ ë¡œë”©ë˜ë©´ ë°”ë¡œ ë²„í¼ë§ ì‹œì‘í•  ê²ƒì¸ì§€ ì—¬ë¶€.
seeking (boolean): ë¯¸ë””ì–´ì˜ íŠ¹ì • ìœ„ì¹˜ë¡œ íƒìƒ‰ ì¤‘ì¼ ë•Œ. íƒìƒ‰ ì „ì´ê±°ë‚˜ íƒìƒ‰ì„ ì™„ë£Œí•œ í›„ì—ëŠ” í•­ìƒ `false`.
defaultPlaybackRate (float): ë¯¸ë””ì–´ ê¸°ë³¸ ì¬ìƒ ì†ë„. (ê¸°ë³¸ê°’ì€ 1.0).
** playbackRate (float): ë¯¸ë””ì–´ ì¬ìƒ ì†ë„ ë°°ì†. (ê¸°ë³¸ê°’ì€ 1.0ì´ë©° ì´ ì†ì„±ì„ ì¡°ì ˆí•˜ë©´ ë¹¨ë¦¬ê°ê¸°ë‚˜ ìŠ¬ë¡œìš° ëª¨ì…˜ ê¸°ëŠ¥ êµ¬í˜„ ê°€ëŠ¥)
** volume (float): ë³¼ë¥¨ í¬ê¸°. (0.0ì—ì„œ 1.0)
mute (boolean): ìŒì†Œê±° ì—¬ë¶€
readyState (integer): video ìš”ì†Œì˜ ì¤€ë¹„ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ëŠ” 0ë¶€í„° 4ê¹Œì§€ì˜ ì •ìˆ˜.
networkState (integer): ë„¤íŠ¸ì›Œí¬ì˜ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ëŠ” 0ë¶€í„° 3ê¹Œì§€ì˜ ì •ìˆ˜.
error (MediaError): ë¯¸ë””ì–´ ì˜¤ë¥˜. (ê°ì²´ê°€ ì˜¤ë¥˜ ë‚¬ì„ ê²½ìš°).

**methods**
load(): ë¯¸ë””ì–´ë¥¼ ì½ì–´ë“¤ì„.
** play(): ë¯¸ë””ì–´ ì¬ìƒ.
** pause(): ë¯¸ë””ì–´ ì¼ì‹œ ì •ì§€.

ì°¸ê³ 
https://eyecandyzero.tistory.com/207
https://taegon.kim/archives/3058
```

### **3. ìŠ¤í‚µ ê¸°ëŠ¥ êµ¬í˜„**

```jsx
function skip() {
  video.currentTime += parseFloat(this.dataset.skip);
}

skipButtons.forEach((button) => button.addEventListener("click", skip));
```

ë¯¸ë¦¬ HTML button íƒœê·¸ì— data-skip ê°’ì„ ì„¤ì •í•´ì¤€ ë’¤
ì´ ê°’ ë§Œí¼ ë¹„ë””ì˜¤ì˜ currentTime ì†ì„±ì„ ë³€ê²½ì‹œì¼œì¤€ë‹¤.

### **4. ì˜ìƒ ì§„í–‰ë„ í‘œì‹œ ê¸°ëŠ¥ êµ¬í˜„**

```jsx
function handleProgress() {
  const percent = (video.currentTime / video.duration) * 100;
  progressBar.style.flexBasis = `${percent}%`;
}

function scrub(e) {
  const scrubTime = (e.offsetX / progress.offsetWidth) * video.duration;
  video.currentTime = scrubTime;
}

video.addEventListener("timeupdate", handleProgress);

let mousedown = false;
progress.addEventListener("click", scrub);
progress.addEventListener("mousemove", (e) => mousedown && scrub(e));
progress.addEventListener("mousedown", () => (mousedown = true));
progress.addEventListener("mouseup", () => (mousedown = false));
```

### **5. ë³¼ë¥¨ ì¡°ì ˆ & ì˜ìƒì†ë„ ì¡°ì ˆ ê¸°ëŠ¥ êµ¬í˜„**

```jsx
function handleRangeUpdate() {
  video[this.name] = this.value;
}

ranges.forEach((range) => range.addEventListener("change", handleRangeUpdate));
ranges.forEach((range) =>
  range.addEventListener("mousemove", handleRangeUpdate)
);
```

ë¯¸ë¦¬ HTML input íƒœê·¸ì— ê°ê° name ê°’ìœ¼ë¡œ â€œvolumeâ€ê³¼ â€œplaybackRateâ€ ë¥¼ ì„¤ì •í•´ì£¼ì–´ range ë°”ë¥¼ ì¡°ì ˆí•  ë•Œ ë§ˆë‹¤ í•´ë‹¹ ì†ì„±ê°’ì„ ë³€ê²½ì‹œì¼œì¤€ë‹¤.

---

## ìµœì¢… ì½”ë“œ

```jsx
const player = document.querySelector(".player");
const video = player.querySelector(".viewer");
const progress = player.querySelector(".progress");
const progressBar = player.querySelector(".progress__filled");
const toggle = player.querySelector(".toggle");
const skipButtons = player.querySelectorAll("[data-skip]");
const ranges = player.querySelectorAll(".player__slider");

function togglePlay() {
  const method = video.paused ? "play" : "pause";
  video[method]();
}

function updateButton() {
  const icon = this.paused ? "â–º" : "âš âš";
  console.log(icon);
  toggle.textContent = icon;
}

function skip() {
  video.currentTime += parseFloat(this.dataset.skip);
}

function handleRangeUpdate() {
  video[this.name] = this.value;
}

function handleProgress() {
  const percent = (video.currentTime / video.duration) * 100;
  progressBar.style.flexBasis = `${percent}%`;
}

function scrub(e) {
  const scrubTime = (e.offsetX / progress.offsetWidth) * video.duration;
  video.currentTime = scrubTime;
}

video.addEventListener("click", togglePlay);
video.addEventListener("play", updateButton);
video.addEventListener("pause", updateButton);
video.addEventListener("timeupdate", handleProgress);

toggle.addEventListener("click", togglePlay);

skipButtons.forEach((button) => button.addEventListener("click", skip));

ranges.forEach((range) => range.addEventListener("change", handleRangeUpdate));
ranges.forEach((range) =>
  range.addEventListener("mousemove", handleRangeUpdate)
);

let mousedown = false;
progress.addEventListener("click", scrub);
progress.addEventListener("mousemove", (e) => mousedown && scrub(e));
progress.addEventListener("mousedown", () => (mousedown = true));
progress.addEventListener("mouseup", () => (mousedown = false));
```
